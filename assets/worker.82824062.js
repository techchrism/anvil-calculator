(function(){"use strict";function k(t,e){const n=Math.max(t.work,e.work),l=t.work+e.work+e.value;return{book:t.book,value:t.value+e.value,work:n+n+1,cost:l,totalCost:t.totalCost+e.totalCost+l,from:[t,e]}}function d(t,e,n){if(n-e===1)return[t[e]];{const l=[];for(let o=e+1;o<n;o++){const r=d(t,e,o),s=d(t,o,n);for(let i=0;i<s.length;i++)if(!!s[i].book)for(let u=0;u<r.length;u++)l.push(k(r[u],s[i]))}return l}}function C(t){let e=t.length,n=[t.slice()],l=new Array(e).fill(0),o=1,r,s;for(;o<e;)l[o]<o?(r=o%2&&l[o],s=t[o],t[o]=t[r],t[r]=s,++l[o],o=1,t[t.length-1].book&&n.push(t.slice())):(l[o]=0,++o);return n}function g(t){if(t<=1)return 1;let e=0;for(let n=0;n<t;n++)e+=g(n)*g(t-n-1);return e}function w(t,e){const n=Date.now();let l=null;const o=C(t),r=100,s=o.length/r;let i=s;for(let a=0;a<o.length;a++){a>i&&e!==null&&(i+=s,e(a/o.length));const h=d(o[a],0,t.length);let c=null;for(let f=0;f<h.length;f++)(c===null||h[f].totalCost<c.totalCost)&&(c=h[f]);c!==null&&(l===null||l.totalCost>c.totalCost)&&(l=c)}return{timeTakenMillis:Date.now()-n,optimalCombination:l,combinationsChecked:o.length*g(t.length)}}onmessage=t=>{const e=t.data,n=w(e.items,l=>{postMessage({type:"progress",id:e.id,progress:l})});postMessage({type:"result",id:e.id,result:n})}})();
